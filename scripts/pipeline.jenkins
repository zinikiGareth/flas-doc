#!/usr/bin/env groovy

pipeline {
    agent any
    stages {
        stage('check out sources') {
            steps {
                dir('documentation') {
                    git credentialsId: 'ssh-gmmapowell', url: 'git@github.com:zinikiGareth/flas-doc.git', branch: 'source'
                }
            }
        }
        stage('flas-guide') {
            steps {
                withEnv(["PATH+JAVA=/opt/jdk-11.0.6+10/bin", "JAVA_HOME=/opt/jdk-11.0.6+10", "SSHID=/home/jenkins/.ssh/id_rsa", "STYLES=styles", "ZINIKI=/home/jenkins/workspace/Build Ziniki/"]) {
                    dir('flas-guide') {
                        sh 'java -jar /home/formatter/formatter.jar guide.cfg'
                    }
                }
            }
        }
        stage('flas-reference') {
            steps {
                withEnv(["PATH+JAVA=/opt/jdk-11.0.6+10/bin", "JAVA_HOME=/opt/jdk-11.0.6+10", "SSHID=/home/jenkins/.ssh/id_rsa", "STYLES=styles", "ZINIKI=/home/jenkins/workspace/Build Ziniki/"]) {
                    dir('flas-reference') {
                        sh 'java -jar /home/formatter/formatter.jar reference.cfg'
                    }
                }
            }
        }
        stage('ziniki-guide') {
            steps {
                withEnv(["PATH+JAVA=/opt/jdk-11.0.6+10/bin", "JAVA_HOME=/opt/jdk-11.0.6+10", "SSHID=/home/jenkins/.ssh/id_rsa", "STYLES=styles", "ZINIKI=/home/jenkins/workspace/Build Ziniki/"]) {
                    dir('ziniki-guide') {
                        sh 'java -jar /home/formatter/formatter.jar zinguide.cfg'
                    }
                }
            }
        }
        stage('ziniki-reference') {
            steps {
                withEnv(["PATH+JAVA=/opt/jdk-11.0.6+10/bin", "JAVA_HOME=/opt/jdk-11.0.6+10", "SSHID=/home/jenkins/.ssh/id_rsa", "STYLES=styles", "ZINIKI=/home/jenkins/workspace/Build Ziniki/"]) {
                    dir('ziniki-reference') {
                        sh 'java -jar /home/formatter/formatter.jar zinreference.cfg'
                    }
                }
            }
        }
    }
}
